@if (application.pages[currentPage]; as page) {
	<div class="container font-rem-1_25 color-white">
		<div class="row">
			<div class="col-12">
				<div class="d-flex justify-content-between">
					<h1>{{ application.title }}</h1>
					<div class="d-none d-md-block w-25">
						<progress-bar [percentage]="getProgressPercentage()"></progress-bar>
					</div>
				</div>

				<div class="spectrum"></div>
				<div class="d-md-none w-100 mb-2">
					<progress-bar [percentage]="getProgressPercentage()"></progress-bar>
				</div>

				@if (submitted) {
					<div class="text-center">
						<div class="mt-3 mt-md-4 font-rem-2 fw-bold">Thank you for submitting a {{ application.title }}@if (application.id !== 'appeal') {!}</div>
						<div class="font-rem-1_5 mx-xl-10">
							<div class="mt-2" [innerHTML]="application.thanks"></div>
						</div>
					</div>
				} @else {
					@if (page.title) {
						<div class="font-rem-2 fw-medium" [innerHTML]="page.title"></div>
					}
					@if (page.description) {
						<div [innerHTML]="page.description"></div>
					}
					@if (page.review) {
						@for (reviewPage of application.pages; track reviewPage) {
							@if (reviewPage.questions?.length > 0) {
								@for (question of reviewPage.questions; track question) {
									@if (getAnswerFormatted(question); as answer) {
										<div class="mt-2">
											<hr>
											<div class="font-rem-1_5 fw-medium mb-1" [innerHTML]="question.label"></div>
											<div class="font-rem-1_125" [innerHTML]="answer"></div>
										</div>
									}
								}
							}
						}
						<hr>
					} @else {
						@for (question of page.questions; track question; let first = $first; let last = $last) {
							<div class="mt-2">
								@if (!first || page.title || page.description) {
									<hr>
								}
								<div class="font-rem-1_5 fw-medium mb-1" [innerHTML]="question.label"></div>
								@if (question.description) {
									<div class="font-rem-1_125" [innerHTML]="question.description"></div>
								}
								@if (question.type == 'short-text') {
									<div class="mt-2" [ngClass]="application.width ?? 'w-100 w-md-75 w-lg-50'">
										<input (input)="setAnswer($event, question)" [value]="getAnswer(question)" placeholder="Answer text" type="text" class="form-control" [id]="question.id" autocomplete="off">
									</div>
								}
								@if (question.type == 'long-text') {
									<div class="mt-2" [ngClass]="application.width ?? 'w-100 w-lg-100'">
										<textarea (input)="setAnswer($event, question)" [value]="getAnswer(question)" placeholder="Answer text" class="form-control" [id]="question.id" [rows]="question.rows ?? 5" autocomplete="off"></textarea>
									</div>
								}
								@if (question.type == 'date') {
									<div class="mt-2" [ngClass]="application.width ?? 'w-100 w-md-50 w-lg-25'">
										<input (input)="setAnswer($event, question)" [value]="getAnswer(question)" placeholder="Date" type="date" class="form-control" [id]="question.id" autocomplete="off" max="2999-12-31">
									</div>
								}
								@if (question.type == 'checkbox' || question.type == 'radio') {
									<div class="mt-2" [ngClass]="application.width ?? 'w-100 w-lg-100'">
										@for (option of question.options; track option) {
											<div>
												<input (input)="setAnswer($event, question, option)" type="{{ question.type }}" [defaultChecked]="getAnswer(question, option)" [id]="option.id" [name]="question.id" [value]="option.value" autocomplete="off">
												<label [for]="option.id" class="ml-1" [innerHTML]="option.label"></label>
											</div>
										}
									</div>
								}
								@if (question.type == 'select') {
									<div class="mt-2" [ngClass]="application.width ?? 'w-100 w-md-75 w-lg-50'">
										<select (change)="setAnswer($event, question)" class="form-select" [id]="question.id" autocomplete="off">
											<option selected value disabled class="d-none"></option>
											@for (option of question.options; track option) {
												<option [id]="option.id" [value]="option.value" [selected]="getAnswer(question, option)" [innerHTML]="option.label"></option>
											}
										</select>
									</div>
								}

								@if (last) {
									<hr>
								}
							</div>
						}
					}

					<div class="mt-3 d-flex justify-content-between">
						@if (firstPage()) {
							<div></div>
						} @else {
							<button class="btn btn-primary font-rem-1_25" [disabled]="firstPage()" (click)="firstPage() ? null : changePage(-1)">
								Previous Page
							</button>
						}
						@if (lastPage()) {
							<loading-button classes="font-rem-1_25" [loading]="submitting" [disabled]="isNextDisabled()" (click)="submit()">
								Submit
							</loading-button>
						} @else {
							<button class="btn btn-primary font-rem-1_25" [disabled]="isNextDisabled()" (click)="lastPage() ? null : changePage(+1)">
								@if (firstPage() && !page.questions) {
									Start Application
								} @else {
									Next Page
								}
							</button>
						}
					</div>
				}
			</div>
		</div>
	</div>
}
